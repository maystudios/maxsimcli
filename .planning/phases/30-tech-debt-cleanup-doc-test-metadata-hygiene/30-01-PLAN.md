---
phase: 30-tech-debt-cleanup-doc-test-metadata-hygiene
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/ROADMAP.md
  - .planning/REQUIREMENTS.md
  - packages/cli/tests/e2e/install.test.ts
autonomous: true
requirements: []
must_haves:
  truths:
    - "ROADMAP.md Phase 16 Goal text says '32 commands, 13 agents' instead of '31 commands, 11 agents'"
    - "install.test.ts it() description says '13 agent' matching the assertion value of 13"
    - "install.test.ts has an assertion that skills files are delivered in templates/skills/"
    - "DASH-06 requirement wording in REQUIREMENTS.md references PUT /api/plan/:path instead of PATCH /api/phases/:id/tasks/:taskId"
    - "ROADMAP.md Phase 30 Success Criterion 6 says 'v2.0 phase SUMMARY.md files (phases 15-29)' instead of 'all 26'"
  artifacts:
    - path: ".planning/ROADMAP.md"
      provides: "Corrected Phase 16 narrative counts"
      contains: "32 commands, exactly 13 agents"
    - path: "packages/cli/tests/e2e/install.test.ts"
      provides: "Correct test description and skills assertion"
    - path: ".planning/REQUIREMENTS.md"
      provides: "Corrected DASH-06 wording"
      contains: "PUT /api/plan/"
  key_links:
    - from: "packages/cli/tests/e2e/install.test.ts"
      to: "templates/skills/"
      via: "readdirSync assertion"
      pattern: "skills"
---

<objective>
Fix stale narrative counts in ROADMAP.md and test descriptions, add skills directory E2E assertion, and align DASH-06 requirement wording with actual API surface.

Purpose: Close 4 of 9 actionable tech debt items from the v2.0 milestone audit — the stale numbers, missing E2E coverage, and incorrect API wording.
Output: Updated ROADMAP.md, REQUIREMENTS.md, and install.test.ts
</objective>

<execution_context>
@./workflows/execute-plan.md
@./templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/v2.0-MILESTONE-AUDIT.md
@packages/cli/tests/e2e/install.test.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix stale counts and test description</name>
  <files>
    .planning/ROADMAP.md
    packages/cli/tests/e2e/install.test.ts
  </files>
  <action>
1. In `.planning/ROADMAP.md`, find the Phase 16 Goal text (around line 51) that says "exactly 31 commands, exactly 11 agents". Change to "exactly 32 commands, exactly 13 agents". Also update Success Criteria #2 on the same phase from "exactly 31 command `.md` files, exactly 11 agent `.md` files" to "exactly 32 command `.md` files, exactly 13 agent `.md` files".

2. In `.planning/ROADMAP.md`, find Phase 30 Success Criteria #6 that says "All 26 SUMMARY.md files with empty `requirements_completed` arrays are backfilled". Change to "All v2.0 phase SUMMARY.md files (phases 15-29) with empty `requirements_completed` arrays are backfilled with actual REQ-IDs". The original "26" count included v1.0 phases (01-14) which are archived and out-of-scope; the correct scope is v2.0 phases only.

3. In `packages/cli/tests/e2e/install.test.ts`, line 16 has `it('installs exactly 13 agent .md files'` — this is ALREADY correct (it was fixed in Phase 27). Verify this is the case. No change needed if it already says 13.
  </action>
  <verify>
    <automated>grep -q "exactly 32 commands, exactly 13 agents" .planning/ROADMAP.md && grep "13 agent" packages/cli/tests/e2e/install.test.ts | grep -q "13" && echo "PASS" || echo "FAIL"</automated>
  </verify>
  <done>ROADMAP.md Phase 16 says 32 commands and 13 agents; install.test.ts description matches assertion value</done>
</task>

<task type="auto">
  <name>Task 2: Add skills E2E assertion and fix DASH-06 wording</name>
  <files>
    packages/cli/tests/e2e/install.test.ts
    .planning/REQUIREMENTS.md
  </files>
  <action>
1. In `packages/cli/tests/e2e/install.test.ts`, add a new test inside the `install file structure (E2E-03)` describe block:

```typescript
it('installs skills directory with skill files', () => {
  const installDir = inject('installDir');
  const skillsDir = join(installDir, '.claude', 'agents', 'skills');
  expect(existsSync(skillsDir)).toBe(true);
  const dirs = readdirSync(skillsDir);
  expect(dirs.length).toBeGreaterThanOrEqual(3);
});
```

This asserts that the skills directory is delivered during install with at least 3 skills (tdd, systematic-debugging, verification-before-completion). Skills are installed under `.claude/agents/skills/` per Phase 26 decisions.

2. In `.planning/REQUIREMENTS.md`, update the DASH-06 wording on line 46 from:
```
- [x] **DASH-06**: Task checkbox toggle via dashboard API (e.g. PATCH /api/phases/:id/tasks/:taskId) updates the corresponding plan `.md` file on disk with `[x]` marking
```
to:
```
- [x] **DASH-06**: Task checkbox toggle via dashboard API (PUT /api/plan/:path with updated content) updates the corresponding plan `.md` file on disk with `[x]` marking
```

This reflects the actual API surface: `PUT /api/plan/*` accepts the full plan content with toggled checkbox, not a PATCH endpoint.
  </action>
  <verify>
    <automated>grep -q "skills" packages/cli/tests/e2e/install.test.ts && grep -q "PUT /api/plan" .planning/REQUIREMENTS.md && echo "PASS" || echo "FAIL"</automated>
  </verify>
  <done>install.test.ts asserts skills directory delivery; DASH-06 wording matches actual PUT /api/plan/:path surface</done>
</task>

</tasks>

<verification>
1. `grep "32 commands" .planning/ROADMAP.md` returns the Phase 16 goal line
2. `grep "13 agent" .planning/ROADMAP.md` returns the Phase 16 success criteria line
3. `grep "13 agent" packages/cli/tests/e2e/install.test.ts` returns the it() description
4. `grep "skills" packages/cli/tests/e2e/install.test.ts` returns the skills assertion test
5. `grep "PUT /api/plan" .planning/REQUIREMENTS.md` returns the updated DASH-06 line
</verification>

<success_criteria>
- ROADMAP.md Phase 16 Goal and Success Criteria say 32 commands, 13 agents
- install.test.ts it() description says 13 agent (matching assertion)
- install.test.ts has a skills directory assertion checking at least 3 skills
- DASH-06 requirement wording references PUT /api/plan/:path
</success_criteria>

<output>
After completion, create `.planning/phases/30-tech-debt-cleanup-doc-test-metadata-hygiene/30-01-SUMMARY.md`
</output>
