{"version":3,"file":"claude.cjs","names":["expandTilde","path","os"],"sources":["../src/claude.ts"],"sourcesContent":["/**\n * @maxsim/adapters — Claude Code adapter\n *\n * Ports the Claude-specific logic from bin/install.js:\n *   - getGlobalDir('claude', ...)  (lines 135-142)\n *   - getDirName('claude')         (line 49)\n *   - getConfigDirFromHome('claude', isGlobal) (lines 58-72)\n *   - copyWithPathReplacement for Claude (lines 839-892)\n */\n\nimport * as path from 'node:path';\nimport * as os from 'node:os';\nimport type { AdapterConfig } from '@maxsim/core';\nimport { expandTilde } from './base.js';\n\n/**\n * Get the global config directory for Claude Code.\n * Priority: explicitDir > CLAUDE_CONFIG_DIR env > ~/.claude\n */\nfunction getGlobalDir(explicitDir?: string | null): string {\n  if (explicitDir) {\n    return expandTilde(explicitDir);\n  }\n  if (process.env.CLAUDE_CONFIG_DIR) {\n    return expandTilde(process.env.CLAUDE_CONFIG_DIR);\n  }\n  return path.join(os.homedir(), '.claude');\n}\n\n/**\n * Get the config directory path relative to home for hook templating.\n * Used for path.join(homeDir, '<configDir>', ...) replacement in hooks.\n */\nfunction getConfigDirFromHome(isGlobal: boolean): string {\n  // Both global and local use '.claude' for Claude Code\n  return \"'.claude'\";\n}\n\n/**\n * Transform markdown content for Claude Code installation.\n * For Claude, this is path replacement only — no frontmatter conversion needed.\n * Replaces ~/.claude/ and ./.claude/ references with the actual install path prefix.\n */\nfunction transformContent(content: string, pathPrefix: string): string {\n  const globalClaudeRegex = /~\\/\\.claude\\//g;\n  const localClaudeRegex = /\\.\\/\\.claude\\//g;\n  let result = content.replace(globalClaudeRegex, pathPrefix);\n  result = result.replace(localClaudeRegex, `./.claude/`);\n  return result;\n}\n\n/**\n * Claude Code adapter configuration.\n * Claude uses nested command structure (commands/maxsim/*.md).\n */\nexport const claudeAdapter: AdapterConfig = {\n  runtime: 'claude',\n  dirName: '.claude',\n  getGlobalDir,\n  getConfigDirFromHome,\n  transformContent,\n  commandStructure: 'nested',\n};\n\n/**\n * Install Claude Code adapter files.\n * Stub — actual install orchestration will be implemented in Phase 5.\n */\nexport function installClaude(): void {\n  // Phase 5 will implement the full install orchestration.\n  // The adapter exposes this function per CONTEXT.md decision.\n  throw new Error('installClaude() not yet implemented — see Phase 5');\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAmBA,SAAS,aAAa,aAAqC;AACzD,KAAI,YACF,QAAOA,yBAAY,YAAY;AAEjC,KAAI,QAAQ,IAAI,kBACd,QAAOA,yBAAY,QAAQ,IAAI,kBAAkB;AAEnD,QAAOC,UAAK,KAAKC,QAAG,SAAS,EAAE,UAAU;;;;;;AAO3C,SAAS,qBAAqB,UAA2B;AAEvD,QAAO;;;;;;;AAQT,SAAS,iBAAiB,SAAiB,YAA4B;CACrE,MAAM,oBAAoB;CAC1B,MAAM,mBAAmB;CACzB,IAAI,SAAS,QAAQ,QAAQ,mBAAmB,WAAW;AAC3D,UAAS,OAAO,QAAQ,kBAAkB,aAAa;AACvD,QAAO;;;;;;AAOT,MAAa,gBAA+B;CAC1C,SAAS;CACT,SAAS;CACT;CACA;CACA;CACA,kBAAkB;CACnB;;;;;AAMD,SAAgB,gBAAsB;AAGpC,OAAM,IAAI,MAAM,oDAAoD"}